object SideEffect

  def firstI(): Int(32) :=
    Std.printInt(1);
    1
  end firstI

  def secondI(): Int(32) :=
    Std.printInt(2);
    2
  end secondI

  def stringLeft(): String :=
    Std.printString("SLeft");
    "a"
  end stringLeft

  def stringRight(): String :=
    Std.printString("SRight");
    "a"
  end stringRight

  def caseLeft(): L.List :=
    Std.printString("CLeft");
    L.Nil()
  end caseLeft

  def caseRight(): L.List :=
    Std.printString("CRight");
    L.Nil()
  end caseRight

  // Make sure that operands to binary operations are interpreted only once
  // and in the right order
  firstI() + secondI();
  firstI() - secondI();
  firstI() * secondI();
  firstI() / secondI();
  firstI() % secondI();

  firstI() < secondI();
  firstI() <= secondI();

  // Make sure that the rhs of comparisons to Unit (which always succeed)
  // are interpreted.
  Std.printString("Left") == Std.printString("Right");

  // Make sure that string comparisons evaluate their arguments once
  // and in the correct order
  stringLeft() == stringRight();

  // Make sure that case class comparisons evaluate their arguments once
  // and in the correct order
  caseLeft() == caseRight();
  ()

end SideEffect